{
'id': 'bugs.core_1148',
'qmid': 'bugs.core_1148',
'tracker_id': 'CORE-1148',
'title': 'Every user can view server log using services API',
'description': 'Ordinary user has access to server log, which is minor security problem.',
'min_versions': None,
'versions': [
{
 'firebird_version': '2.0.2',
 'platform': 'All',
 'test_type': 'Python',
 'test_script': """from fdb import services
con = services.connect(host='localhost', user=user_name.encode(), password=user_password.encode())
try:
   con.getLog()
   print 'sucess'
except Exception, e:
   print e[0]
con = services.connect(host='localhost', user='TEST', password='test')
try:
   con.getLog()
   print 'sucess'
except Exception, e:
   print e[0]


""",
 'expected_stdout': """sucess
Unable to perform the requested Service API action:
- SQLCODE: -901
- Unsuccessful execution caused by system error that does not preclude successful execution of subsequent statements
- Unable to perform operation.  You must be either SYSDBA or owner of the database
""",
 'resources': ['test_user']
}
]
}
